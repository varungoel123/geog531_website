<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="200 points ">
<meta name="author" content="GEOG 510, GIS &amp; Spatial Analysis in Public Health ">
<meta name="author" content="Varun Goel">
<meta name="dcterms.date" content="2025-04-28">

<title>GEOG 510 - GEOG 510: Final Project Paper</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">GEOG 510</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-materials">    
        <li>
    <a class="dropdown-item" href="../lectures.html" rel="" target="">
 <span class="dropdown-text">Lectures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../readings.html" rel="" target="">
 <span class="dropdown-text">Readings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../exercises.html" rel="" target="">
 <span class="dropdown-text">Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments.html" rel="" target="">
 <span class="dropdown-text">Assignments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../final_project/GEOG510_FinalProject.html" rel="" target="">
 <span class="dropdown-text">Final Project Paper</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../final_project/GEOG510_FinalPresentation.html" rel="" target="">
 <span class="dropdown-text">Final Project Presentations and Assessment</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../software.html" rel="" target="">
 <span class="dropdown-text">Software Requirements and Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../data.html" rel="" target="">
 <span class="dropdown-text">Data Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tutorials.html" rel="" target="">
 <span class="dropdown-text">Tutorials and Technical Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../mapping.html" rel="" target="">
 <span class="dropdown-text">Map Submission Checklist</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overall-project-paper-goal" id="toc-overall-project-paper-goal" class="nav-link active" data-scroll-target="#overall-project-paper-goal">Overall Project Paper Goal</a></li>
  <li><a href="#paper-requirements" id="toc-paper-requirements" class="nav-link" data-scroll-target="#paper-requirements">Paper requirements</a></li>
  <li><a href="#paper-organization" id="toc-paper-organization" class="nav-link" data-scroll-target="#paper-organization">Paper Organization</a></li>
  <li><a href="#section-content" id="toc-section-content" class="nav-link" data-scroll-target="#section-content">Section Content</a></li>
  <li><a href="#justification-for-using-gis-or-geographic-thinking" id="toc-justification-for-using-gis-or-geographic-thinking" class="nav-link" data-scroll-target="#justification-for-using-gis-or-geographic-thinking">Justification for using GIS or geographic thinking</a></li>
  <li><a href="#figures-and-tables" id="toc-figures-and-tables" class="nav-link" data-scroll-target="#figures-and-tables">Figures and Tables</a></li>
  <li><a href="#formatting-length-and-other-requirements" id="toc-formatting-length-and-other-requirements" class="nav-link" data-scroll-target="#formatting-length-and-other-requirements">Formatting, length, and other requirements</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation">Evaluation</a>
  <ul class="collapse">
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline">Timeline</a></li>
  <li><a href="#deliverables" id="toc-deliverables" class="nav-link" data-scroll-target="#deliverables">Deliverables</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GEOG 510: Final Project Paper</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>200 points  </p>
             <p>GEOG 510, GIS &amp; Spatial Analysis in Public Health  </p>
             <p>Varun Goel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
a {
  color: royalblue;
}

a:hover {
  color: darkorange;
}

div.highlightblock { 
 background-color: #e0f0ff; 
 padding: 10px 10px 3px 10px;
}
</style>
</div>
<hr>
<section id="overall-project-paper-goal" class="level2">
<h2 class="anchored" data-anchor-id="overall-project-paper-goal">Overall Project Paper Goal</h2>
<p>For your final project paper, you are required to implement an analysis that leverages GIS and spatial analytic techniques to answer a health-research question. There is no minimum or maximum number of operations you need to perform in your analysis, but there are some general principles that you should follow. Here are also 3 examples of past projects from another version of this class to provide you some idea. <u>Please note though that some requirements for our class may be different than what was required for these sample projects.</u></p>
<p>Example Project Papers (PP):</p>
<p><a href="./GEOG510_finalpaper_example1.pdf" target="_blank">PP1: Landuse and rodent inspections</a></p>
<p><a href="./GEOG510_finalpaper_example2.pdf" target="_blank">PP2: Lead and Private wells</a></p>
<p><a href="./GEOG510_finalpaper_example3.pdf" target="_blank">PP3: Medicaid network suitability for OB/GYN facilities</a></p>
<p>1) You should have a main research question that is related to a health-related outcome, AND also focuses on investigating the role of the underlying process(es) that may have generated the spatial distribution of the health-related outcome that you are interested in. My general advice for this project is aim for a focused, tight, organized, and rigorous analysis, than focusing on a complex question. Infact, I would much rather <u><strong>you ask a simple question and answer it very well</strong></u> than have you ask an awesome question and not do a very good job of answering it. The 3 PPs all have good, feasible research questions that could be answered using tools learned in the class.</p>
<p>2) Your analysis should include some of the <u><strong>descriptive statistics and maps</strong></u> that we have learned in class. The purpose of these is to describe to the reader, important summaries and spatial distribution of variables related to your research question. Take a look at PP2. Figure 1-4 are good examples of descriptive maps, and section 3.1 is a good example of descriptive statistics. Similarly, in PP3, notice how they use network analysis to describe service areas.</p>
<p>3) Your analysis should include some of the <strong>exploratory GIS and spatial analysis</strong> techniques that we have learned in class. These are techniques that help you <u><em>identify patterns</em></u> objectively in your datasets so that you can begin to think about <u><em>what may be the underlying processes</em></u> that are driving those patterns that you observe. Ideally, you would incorporate atleast some global and local autocorrelation analysis in your project to identify important patterns and hypothesize about underlying processes. All three example papers use Global and Local Moran’s I to conduct exploratory analysis.</p>
<p>4) Ultimately, your main research question should to be <strong>explanatory</strong> in nature, in an attempt to understand, at least on some level, the <u><em>process generating the spatial pattern(s)</em></u>. This is where you start generating or testing evidence of whether/how certain processes might generate the spatial pattern of the health outcome that you observe. A good example of this analysis is PP1 and PP3. In PP1, the authors use spatial regression to examine whether certain landuse characteristics may be driving rodent inspection rates. IN PP3, they assess whether being in a service area may be linked to medicaid enrollment.</p>
<p><u>There may be some exceptions to this rule.</u> For example, you may be interested in <strong>prediction (</strong>such as predicting infectious disease incidence in vulnerable areas during an outbreak) , and not explanation. However, even predictions need to be informed by an understanding of processes driving existing patterns. Similarly, some of you may be interested in an <strong>intervention</strong>. An example is PP2, where the authors try to identify sites with high proportion of private wells and lead risk that should be prioritized for water infrastructure modernization. However even these studies are based on underlying theory about processes (eg. lead being a problem in private wells and caused by old water infrastructure).</p>
<p>5) Ultimately, I understand that these requirements will be different for everyone’s particular project, so <u><strong>please talk with me, if you have any doubts or questions.</strong></u> If you leave everything towards the end, there is no guarantee that I will be able to help you in my full capacity.</p>
<hr>
</section>
<section id="paper-requirements" class="level2">
<h2 class="anchored" data-anchor-id="paper-requirements">Paper requirements</h2>
<p>The purpose of the final paper is to learn how to communicate the findings of your GIS and Spatial Analysis to a general academic audience (who may or may not be well-versed with GIS and spatial analysis). Below, I have outlined steps and components for the organization of your output.</p>
<p>I understand that some of you may be using the final project for some other purpose such as thesis, dissertation proposal, paper publication etc. Or some of you may have other creative ideas for your final project such as presenting in the form of a poster for Discover USC or other conferences. <u><strong>Please speak with me and we can work out a way to accommodate your unique situation</strong></u>. Ultimately, I want you to have the class project be useful to you in addition to getting a good grade.</p>
<hr>
</section>
<section id="paper-organization" class="level2">
<h2 class="anchored" data-anchor-id="paper-organization">Paper Organization</h2>
<p>Barring any exceptions that are communicated with me, your project should have the following components. Details for each section are discussed in the Section Content.</p>
<p>1) Your project should have a title. Please include your name. Please do not create a separate page with a title/and your name.</p>
<p>2) Your paper should be roughly organized into the following sections.</p>
<ul>
<li><strong>Introduction</strong>
<ul>
<li>Main question/objective<br>
</li>
<li>Background</li>
</ul></li>
<li><strong>Materials and Methods</strong>
<ul>
<li>Data and Preprocessing</li>
<li>Methods<br>
</li>
</ul></li>
<li><strong>Results</strong><br>
</li>
<li><strong>Discussion and Conclusions</strong><br>
</li>
<li><strong>References</strong></li>
</ul>
<hr>
</section>
<section id="section-content" class="level2">
<h2 class="anchored" data-anchor-id="section-content">Section Content</h2>
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction">Introduction</h4>
<p>Provides a broad overview of the health topic and why it is important (think “big picture” here). Aim for roughly 2-3 paragraphs for the first part of this section. Think of your Introduction as a funnel… start with big ideas and use each paragraphs to narrow down to a problem statement and research question. Your research question should be extremely easy for me (the reader) to identify.</p>
<section id="background" class="level5">
<h5 class="anchored" data-anchor-id="background"><em>Background</em></h5>
<p>This section falls directly between the Introduction, which should build to your problem statement and research question, and the Materials and Methods, which explains data and method(s) you used to answer your research question. The Background should function as a bridge between these two sections. By reviewing the previous literature, you will be providing additional context to the Introduction content and providing important foundational information that will assist the reader in understanding the motivation or justification for your work (for some, this section also might require a review of your overall analytical approach– but not a deep dive into the methods). Aim for roughly 2-3 paragraphs for this subsection.</p>
</section>
</section>
<section id="materials-and-methods" class="level4">
<h4 class="anchored" data-anchor-id="materials-and-methods">Materials and Methods</h4>
<p>This section will likely be split into Data and Preprocessing and Methods. In GIS-based analysis, it is often the case that there were a number of operations performed to get the data ready for the actual analysis. In a sense, these are not “methods” because they were not analytic methods used to answer the research question. Sometimes, this line is blurry; however, generally, it is pretty easy to separate out what was preprocessing and what was analysis.</p>
<section id="data-and-preprocessing" class="level5">
<h5 class="anchored" data-anchor-id="data-and-preprocessing"><em>Data and Preprocessing</em></h5>
<p>This section should have link(s) or references to where you acquired the data from. You do not have to provide every single minute detail of the pre-processing steps, but should provide enough detail that another person could reasonably reproduce what you did to acquire and prepare the data for analysis.</p>
</section>
<section id="methods" class="level5">
<h5 class="anchored" data-anchor-id="methods"><em>Methods</em></h5>
<p>Here, detail the analytic method(s) that you used to answer the research question. Don’t be afraid to use signposts back to your research question(s) here, e.g., “To answer this or that… I used this method”. Include your global and local spatial autocorrelation methods here, as well as the method/techniques that you used to answer your main research question.</p>
</section>
</section>
<section id="results" class="level4">
<h4 class="anchored" data-anchor-id="results">Results</h4>
<p>Pretty self explanatory. Again, don’t be afraid to use signposts back to your research question(s) here, e.g., “The results of this test answer our question of this or that”. Keep this section straightforward, e.g., save any larger discussion or explanation of what the results “mean” in a broader sense for the following section.</p>
</section>
<section id="discussion-and-conclusions" class="level4">
<h4 class="anchored" data-anchor-id="discussion-and-conclusions">Discussion and Conclusions</h4>
<p>You can separate these sections or combine them. Here is where you can expand upon the broader implications of your results or to compare your results to results from previous studies. You can also use this area to discuss “future research” (not required, but recommended). You should also use this area to critically discuss “limitations” of your analysis. These could be due to data issues, MAUP, not being able to use a more sophisticated method, etc. Wrap up your paper with a short summary of the main takeaways from your analysis.</p>
</section>
<section id="references" class="level4">
<h4 class="anchored" data-anchor-id="references">References</h4>
<p>List your cited literature.</p>
<hr>
</section>
</section>
<section id="justification-for-using-gis-or-geographic-thinking" class="level2">
<h2 class="anchored" data-anchor-id="justification-for-using-gis-or-geographic-thinking">Justification for using GIS or geographic thinking</h2>
<p>Somewhere in the paper, you must include a brief paragraph that provides a short justification that explains why using GIS and spatial data (or spatial thinking) is important for the health-related topic you are studying. Good places for this are in the Introduction after the Research Question or in the Discussion and/or Conclusions section. Basically explain why your analysis is 1) different / better / more interesting than a non-spatial analysis would be and/or 2) why GIS processing/analysis is so important to being able to ask/answer your Research Question. <em>Please be sure to include this as a labeled subsection so it is easy to locate!</em></p>
<hr>
</section>
<section id="figures-and-tables" class="level2">
<h2 class="anchored" data-anchor-id="figures-and-tables">Figures and Tables</h2>
<p>Feel free to use figures and tables that you generate (no internet or copy/pasting from other sources) as necessary and appropriate in your paper. Keep in mind that maps are figures! You should have at the bare minimum one map, but I would suggest making multiple maps (e.g., one of your main outcome variable, one of your LISA/SaTScan results). Make sure to design your map(s) for the medium… a portion of a 8.5”x11” piece of paper (please try to stay away from making “full page” figures). I will be evaluating things like text size and design of your map(s).</p>
<p><strong>Absolutely no screenshots of ArcGIS or statistical software output!</strong></p>
<p>Place the figures or tables “inline” (in the body) of the paper. Do not use text wrapping! Every figure and/or table must have a figure/table number and a short, descriptive caption. Do not use floating text boxes for captions! Every figure/table included in the paper must be referenced in the main body of the text, for example:</p>
<p>Diabetes prevalence appears to be much higher in the southeastern states of the US (see Figure 1).</p>
<p>Figure 1 shows that diabetes prevalence is highest in the southeastern states of the US.</p>
</section>
<section id="formatting-length-and-other-requirements" class="level2">
<h2 class="anchored" data-anchor-id="formatting-length-and-other-requirements">Formatting, length, and other requirements</h2>
<p>Use Times New Roman, Cambria, Arial or another plain font for your paper. Your document should have 1 inch margins and be double spaced. You can organize the sections as you see fit, but generally follow the format I provided above. I like to use numbered sections and subsections, but you do not have to do this.</p>
<p>You must cite, at a minimum, 8 papers or reports. Use any format you prefer for citing information in the text. All I ask is that you be consistent throughout your paper and make sure that everything you cite in the text is correctly referenced in the References section of the paper.</p>
<p>The body of your paper, which includes everything but the References, should be a minimum of 2,000 words and a maximum of 3,000 words. This roughly translates to 8-12 double spaced pages, given the formatting requirements above. However, please use the word limits I have provided, rather than the page limits, as everyone’s writing style is a bit different and the inclusion of figures/tables throws page limits off. A long paper does not necessarily mean a good paper, so do not “stretch or pad” your writing or include extraneous, unnecessary, and/or superfluous content. I am a fan of clear, organized, and coherent writing. So, please do not “pad” your writing with extra words in an effort to make your paper longer.</p>
<p>Create a single word-processed document. Make sure to include your name in the document and provide a title for your paper.</p>
<hr>
</section>
<section id="evaluation" class="level2">
<h2 class="anchored" data-anchor-id="evaluation">Evaluation</h2>
<p>You will be evaluated on the quality/robustness of the research design and analysis, the quality and clarity of writing and organization in your manuscript, and the quality of any non-text material you include (especially your maps).</p>
<p>I will provide a more detailed grading rubric later in April, but as long as your follow the overall structure, you will be in good shape.</p>
<p><a href="./GEOG510_finalProjectGrading.docx">Click here to access Grading Rubric for final project</a></p>
<hr>
<p>** <em>Please start early and get in touch with me if you have any questions regarding anything about the assignment or requirements.</em> **</p>
<hr>
<section id="timeline" class="level3">
<h3 class="anchored" data-anchor-id="timeline">Timeline</h3>
<p>Even if you did not know it, you all have already started thinking about your final paper topics already through data searching for topics of interest to you and map making as part of your assignment components. As we move forward, I will continue to embed parts related to your final project in future assignments. Additionally, I will also have some structured checkpoints till the end of the semester to help ensure that you have all the help needed to execute a final project. If you follow them timel;y, there is a good likelihood that your final papers will be solid and most importantly stress-free! Here are the suggested checkpoint deadlines:</p>
<ul>
<li><p><u><strong>March 25: Have a finalized main research question</strong></u></p>
<p>If you have not already, start thinking about your topic of interest and narrow down on a research question based on the data that you have been finding. If you are struggling with ideas about your final projects <u><strong>please get in touch with me before and I can help you think about a question or help finding data.</strong></u></p></li>
<li><p><u><strong>April 10: Finalize data, and conduct descriptive and exploratory analysis. Atleast have a plan for all your GIS and Spatial Analysis</strong></u></p>
<p>Based on your research question, make sure that you actually have data to answer the question, and ideally you would have also conducted some descriptive and exploratory analysis. Even if you have not finished your analysis, make sure you know what analyses you will run for your question.</p></li>
<li><p><u><strong>April 25: Finish all analyses, have materials and methods and results section written</strong></u></p>
<p>This is not followed by everyone, but in such papers, I like to have my materials and methods, and results section written before I write other parts of the paper, including introduction and the discussion. If you have completed all your analyses and have these sections written, you can likely finish rest of the paper before the deadline. I will also give you a chance to submit any paper drafts that you have at this time to get feedback from me.</p></li>
<li><p><u><strong>May 5 (by 12:30 pm): Submit final paper</strong></u></p>
<p><strong>This is A HARD DEADLINE</strong> as I need to submit grades within 72 hours of our final exam. Please have your final paper turned in by this time.</p></li>
</ul>
<hr>
</section>
<section id="deliverables" class="level3">
<h3 class="anchored" data-anchor-id="deliverables">Deliverables</h3>
<p>Upload your paper (userid_finalpaper.docx) to your OneDrive folder by <u><strong>May 5 (by 12:30 pm).</strong></u></p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>